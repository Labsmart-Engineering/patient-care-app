<%
  profiler = MemoryProfiler
  profiler.start
%>
<div class="p-20">
  <center>
    <h1 class="mb-10 text-5xl font-bold text-blue-700">PATIENTS</h1>
    <table class="table table-success table-striped-columns p-10">
      <thead>
        <tr>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Phone Number</th>
          <th>Email</th>
          <th>Disease</th>
          <th>Age</th>
          <th colspan="3"></th>
        </tr>
      </thead>
      <tbody>
        <% @patients.each do |patient| %>
          <tr>
            <td><%= patient.first_name %></td>
            <td><%= patient.last_name %></td>
            <td><%= patient.phone_number %></td>
            <td><%= patient.email %></td>
            <td><%= patient.disease %></td>
            <td><%= patient.age %></td>
            <td><%= link_to 'Show', patient, class: "btn btn-primary" %></td>
            <td><%= link_to 'Edit', edit_patient_path(patient), class: "btn btn-secondary" %></td>
            <td><%= link_to 'Destroy', patient, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger" %></td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <%= link_to 'Add a Patient', new_patient_path, class: "bg-blue-700 p-2 mt-10 text-white font-bold rounded-md hover:bg-blue-500" %>
  </center>
</div>
<%
  report = profiler.stop
  total_allocated = report.total_allocated
  total_allocated_memsize = report.total_allocated_memsize
  total_retained = report.total_retained
  total_retained_memsize = report.total_retained_memsize

  Rails.logger.info "Memory Profiling Report for new method #{action_name}:"
  Rails.logger.info "Total Allocated: #{total_allocated}"
  Rails.logger.info "Total Allocated Memory Size: #{total_allocated_memsize}"
  Rails.logger.info "Total Retained: #{total_retained}"
  Rails.logger.info "Total Retained Memory Size: #{total_retained_memsize}"
  Rails.logger.info "No memory profiler report available."
%>
